<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Random Head Dumps]]></title>
  <link href="http://cabeca.github.io/atom.xml" rel="self"/>
  <link href="http://cabeca.github.io/"/>
  <updated>2013-06-09T15:08:44+01:00</updated>
  <id>http://cabeca.github.io/</id>
  <author>
    <name><![CDATA[Miguel Cabeça]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Firefox: same origin policy woes with private adress ranges]]></title>
    <link href="http://cabeca.github.io/blog/2013/06/09/firefox-same-origin-policy-woes-with-private-adress-ranges/"/>
    <updated>2013-06-09T13:48:00+01:00</updated>
    <id>http://cabeca.github.io/blog/2013/06/09/firefox-same-origin-policy-woes-with-private-adress-ranges</id>
    <content type="html"><![CDATA[<p>Suppose you have an html page and you want to embed an <a href="http://css-tricks.com/using-svg/">SVG</a> in it for later manipulation. One of the possible ways to do it is using an <code>object</code> tag like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;the_logo&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;object</span> <span class="na">type=</span><span class="s">&quot;image/svg+xml&quot;</span> <span class="na">data=</span><span class="s">&quot;images/awesome_logo.svg&quot;</span> <span class="na">id=</span><span class="s">&quot;awesome_logo&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    You&#39;re missing out on an Awesome logo with that old browser!
</span><span class='line'>  <span class="nt">&lt;/object&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>And using some javascript to manipulate, say, a node&rsquo;s opacity:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">fade_out_lettering</span><span class="p">(){</span>
</span><span class='line'>  <span class="c1">// Get the svg content document embedded in out document </span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;awesome_logo&#39;</span><span class="p">).</span><span class="nx">contentDocument</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// use jQuery to select an SVG element, using svg as the search context</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#lettering&#39;</span><span class="p">,</span><span class="nx">svg</span><span class="p">).</span><span class="nx">animate</span><span class="p">({</span><span class="nx">opacity</span><span class="o">:</span> <span class="mi">0</span><span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, suppose that you use private addresses in the context of your development environment. You access your development (virtual) machine using some ip address in Chrome:</p>

<p><code>http://10.0.0.10:3000/</code></p>

<p>And you see your glorious svg logo lose it&rsquo;s letters in a nice fade. Check with Safari, and the same beautiful experience. Check with firefox, aaaaaand&hellip; nothing!
Open up the inspector and you&rsquo;ll see something like this (or similar):</p>

<p><img src="http://cabeca.github.io/images/firefox_inspector.png" alt="Firefox" /></p>

<p>What the hell? Permission denied in the context of access to embedded documents (iframes, svgs&hellip;) usually means violations of the <a href="http://en.wikipedia.org/wiki/Same_origin_policy">same origin policy</a>, but in this case the contents are all local, and share the same protocol, host and port number. Besides, it works on all other cool browsers! What&rsquo;s going on?</p>

<p>Well, it seems firefox has some issues checking same origin policy with private adresses (or is it any ip address?). Just to validate this theory, use an ip-to-name tool like <a href="http://xip.io">xip.io</a> to check the page again. You access your development maching using a name instead of an ip address:</p>

<p><code>10.0.0.10.xip.io:3000/</code></p>

<p>And <em>voilá</em>! The letters also fade in firefox (version 21 in my case)! So now you can deploy your shiny logo confident that it will work when your users view it served from production machines. I&rsquo;m assuming you do use a domain name for your site&hellip;</p>

<p>This firefox idiosyncrasy applies to embedded svgs, but also to iframes, and probably to any other object you can embed in your page.</p>

<p>Hat tip to <a href="http://twitter.com/luismreis">@luismreis</a> for the xip.io trick. Thanks!</p>
]]></content>
  </entry>
  
</feed>
